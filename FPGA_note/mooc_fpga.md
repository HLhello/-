

第一章

1. 生活中的芯片有80%是可以与互联网通信的，芯片分为模拟芯片，数字芯片，数模混合芯片
2. 新型技术：人工智能，VR，模式识别，金融等的特点
   1. 技术趋势上训练数据样本量巨大
   2. 数据密集型高性能计算的规模迅速增长
   3. 并行存储容量和带宽的要求越来越高
   4. 对网络要求带宽更高并且演示更低
3. 对硬件芯片提出更高要求——这就需要FPGA及ASIC，特点
   1. 效能更高
   2. 并行模式更宽泛
   3. 支持数据并行和任务并行
   4. 计算密度高
4. 芯片产业链
   1. foundry 晶圆厂
      1. TSMC，台积电，啥子变成制作芯片的材料
   2. fabless 无晶圆设计公司
      1. broadcom，qualcomm，nvidia，华为海思，紫光
   3. EDA 软件公司
      1. 自动化软件三巨头，candence，synopsys，menbrgraphics,华大九天
   4. Design Service设计服务公司
      1. verisilicon，lalchip
   5. IP vender IP供应商
      1. arm
   6. IDM 集成设计与制造
      1. 大疆，比特大陆，小米
5. 就业岗位
   1. 算法/IC架构
   2. 数字IC前端设计《=======目标
   3. 数字IC验证
   4. IC后端
   5. 模拟IC设计
   6. 混合IC设计
   7. 版图设计
   8. IC生产/封装/测试/运营
   9. 方案硬件开发
   10. Firmware嵌入式驱动开发
   11. IC市场/销售/FAE
   12. 技术市场
6. 前端设计
   1. 功能和指标定义
   2. 架构设计
      1. 完成芯片中数字部分的高层次算法。为应将提供一个正确的软件功能模型
      2. 架构的分析与建模，为RTL实现提供总体性的设计指导
      3. 使用工具，matlab（通信，数字信号处理），c++，c，sv，system c
   3. RTL编写
      1. 完成高层次描述到Verilog HDL的实现
      2. VIM，EMAC
   4. 功能验证（前仿真）
      1. 动态仿真，时间长，主要是功能是否完善，耗时较长
      2. 使用工具 modelsim，VCS
      3. c++，c，sv，基于UVM方法学
   5. 逻辑综合，优化（从此开始需要考虑物理特性，电特性）
      1. 将RTL代码映射为与工艺库相关的网表
      2. 频率，面积，功耗，等多种条件约束的工程优化问题
      3. 插入DFT，clock gating
      4. 加入memory，各种IP等，I/O，PLL
      5. DesignComplier
   6. 一致性验证
      1. RTL代码，逻辑综合后的网表都可抽象为两个由节点和边构成的图，这个环节通过比较这两张图是否一致的方法来确定逻辑综合生成的网表是否正确
      2. 输入的文件：RTL代码，netlist，约束
      3. 输出的文件：match和verify的报告
   7. DFT
   8. 单元布局
   9. 时钟树综合
   10. 布线
   11. DRC/LVS
   12. 自动生成版图
   13. 功能验证（后仿真）
   14. 流片
   15. 数字后端（物理设计）
       1. 将网表格式的文件转化为一个个有物理位置和大小的单元，连线等
       2. 考虑面积，功耗，性能的要求
7. 逻辑综合优化
   1. 静态时序分析——保证设计中所有的路径，满足内部时序单元对建立时间和保持时间的要求
   2. 上一句话的解释：无论起点是什么，信号都可以被计时的传递到该路径的重点，并且在电路正常工作的时间段内保持恒定
   3. 工具 PrimeTime，Tempus
   4. sdc同逻辑综合一起，STA中会修大量的steup，hold，前端修timing较快，但是代码是经过长时间的功能验证的，这样做后还需不需要进行功能验证，所以一般前端不修timing

第二章

第一课

1. 硬件语言的基本概念

   1. 互连（connectivity）wire型变量描述各个模块之间的端口与网线连接关系
   2. 并发（concurrecy）可以有效的描述并行的硬件系统
   3. 时间（time） 定义了绝对和相对的时间度量，可综合操作符具有的物理延迟

2. 可综合的四大法宝

   1. always，if-else，case，assign

3. if-else语句优化

   1. 根据需要选择先加后选，先选后加

      1. 例：通常加法器消耗晶体管较多，选择先加后选择电路面积较大，如果选择先选后加则对选通信号有较高要求，如果选通信号到来较迟，则影响电路的频率

   2. 单if语句，无aaaaa优先级的判断结构，推荐使用单if语句

      1. 单if语句与多if语句的区别 

         ```verilog 
         always@(*)
         being 
         	z = 0;
         	if(sel13)
         		z = d;
         	else if(sel12)
         		z = c;
         	else if(sel1)
         		z = b;
         	else if(sel0)
         		z = a;
         end
         //****************************************
         always@(*)//多if结构
             begin
                 z=0;
                 if(sel1) z = b;
                 if(sel2) z = c;
                 if(sel13) z = d;
                 if(sel10) z = a;
             end
         //思考两种写法的生成的电路
         ```

4. case语句

   1. 与单if语句的区别是条件是互斥的，多用于指令译码电路

5. latch

   1. 综合器很难解释latch，因此除非特殊用途，一般避免一如latch

   2. 寄存器与锁存器的区别

      1. 寄存器是边沿触发的， 例```always@(posedge clk) q<=data;```
      2. 锁存器是电平敏感的，例```always@(*) if(enable) y = data;```
      3. 思考上述两行代码的时序图

   3. latch的缺点

      1. latch由电平触发，非同步控制，在使能信号有效时latch相当于通路，在使能信号无效时latch保持输出状态，dff由时钟沿触发，同步控制
      2. latch容易产生毛刺，dff则不易产生毛刺
      3. latch将静态时序分析变得极为复杂

   4. 一般的设计规则

      1. 在绝大多数设计中避免产生latch，latch最大的危害在于不能过滤毛刺，这对于下一级电路是极其危险的，所以只要能用d触发器的地方，就不用latch

   5. 容易引入latch的途径使用不完备的条件判断语句

      1. 例

         ```Verilog
         always@(*)
         	begin
         		if(cond ==1)
         			data_out = data_in;
         	end
         //********************************
         always@(*)
         	case{sel0,sel1,sel2}
         		2'd0:z = d;
         		2'd1:z = b;
         		2'd2:z = c;
         	endcase
         	
         ```

      2. 尽量使用完备的if-else

      3. 为case语句添加一个default语句

6. 逻辑复制，负载均衡

   1. 在电路设计中，若果发现一个信号驱动的负载过多，同一个信号赋值给较多的信号，可以通过信号复制，进而降低信号的传播延迟，提高性能 

7. 资源共享，减小面积

   1. 在电路设计中，如果发现同一组信号驱动好几个不同的信号，可以通过资源共享的方式减小面积，不过在现在的计数条件下， 面积优化的重要性一般低于性能优化

   2. 例

      ```Verilog
      sum1 <= a + b + c;
      sum2 <= a + b + d;
      sum3 <= a + b + e;
      //优化后
      temp = a + b;
      sum1 <= temp + c;
      sum2 <= temp + d;
      sum3 <= temp + e;
      
      ```

8. 资源顺序重排，降低传播延时

   1. 将到来较晚的信号放在后面，隐藏其延迟

   2. ```Verilog
      z = a+b+c+d;//a信号到来较晚
      //优化后
      z = ((b+c)+d)+a;
      ```

9. 三目运算符仅用于连线，always用于逻辑计算

   1. ？：仅用于信号连接，多层嵌套后难以阅读，并很难被综合器解释

   2.  例

      ```verilog
      assign a = (b==1)?((c&&d)? 1'b1:1'b0):1'b0;
      //优化后
      always@(*)
      	begin
      		if(b==1)
      			if(c&&d==1)
      				a = 1'b1;
      			else 
      				a = 1'b0;
      		else 
      			a = 1'd0;
      	end
      ```

10. 可综合风格

    1. 完整的always敏感喜好列表
    2. 每个always敏感信号列表对应一个时钟
    3. 不允许wait生命和#delay声明（在不需要综合的模块中可以使用）
    4. 非阻塞<=，阻塞=

11. 模块划分

    1. 分开异步逻辑和同步逻辑
    2. 分开控制逻辑和存储器

第二课

1. 性能
2. 面积-->成本,功耗，对于FPGA中更是影响到芯片的选型
   1. 操作符的使用，对操作符进行重视
   2. 多比特信号的操作
3. 功耗
   1. $P_d =  sum ` a*f*C*V $
   2. a翻转次数，f工作频率，C该点的电容，V电压值, $p_d$电路个点的功耗总和
   3. 电容和电压RTL代码无法改变
   4. 减小功耗的办法
      1. 门控时钟
      2. 增加使能信号
      3. 对模块进行控制，需要时工作
      4. 毛刺会增加大量的功耗，但是毛刺无法避免，需要把产生毛刺的电路放在电路传播的最后
      5. 控制电路翻转次数
         1. 减少编码的翻转次数
4. 在RTL编码中考虑布局布线问题
   1. 布局布线中的热点问题
      1. 设计的功能在一定的面积内使用大量的布线资源
      2. 使用了一个支路很多的mux，可以通过分级等办法来解决

第三课

1. RTL设计指导原则
   1. RTL级设计的拼盘标准
      1. 时序性能
      2. 所占面积
      3. 可测试性
      4. 可重用性
      5. 功耗
      6. 时钟域的分配
      7. 复位信号的设计
      8. 是否与EDA工具匹配
      9. 是否发挥芯片的特点
   2. 一般意义的指导原则
      1. 面积与速度互换，乒乓操作，流水线
   3. 面积与速度互换
      1. 面积
         1. 对于FPGA可以用所消耗的触发器（CFF），和查找表数量来衡量
      2. 速度
         1. 设计在芯片上稳定运行时所能够达到的最高频率，这个频率有设计的时序状况决定
         2. 时钟周期，pad to pad time，clock setup time，clock hold time，clock to output delay
      3. 在满足设计时序要求的前提下，占用最小的芯片面积
      4. 在所规定的的面积下，使设计的时序余量更大，频率更高
      5. 设计余量比较大，运行的频率较高
         1. 设计的健壮性更强
         2. 整个系统的质量更有保证
      6. 设计所消耗的面积更小
         1. 在单位芯片上实现的功能模块更多，需要芯片的数量更少
         2. 成本降低
      7. 面积和速度冲突，速度优先
      8. 操作技巧：乒乓操作，模块复用，串并转换
   4. 乒乓操作
      1. 特点
         1. 输入数据选择单元与输出数据选择单元按节拍相互配合转换
         2. 经过缓冲的数据流===》数据流运算处理模块===》进行运算与处理
         3. 在再这个模块的两端看数据，输入数据流和输出数据流式连续不断的，没有任何停顿，因此非常适合对数据流进行流水线处理
      2. 可以节约缓冲空间
         1. 例
            1. 在WCDMA基带应用中，一帧数据分为15个时隙，数据速率是3.84Mbps，一帧时长10ms
               1. 缓冲一帧数据所需内存38400bit
               2. 乒乓操作后，只需要两个ram来进行操作，缓存一个时隙的数据送入处理单元，只需要38400/15 = 2560bit==》2560*2bit的缓存空间
      3. 用低速模块处理高速数据流的例子
   5. 流水线
      1. 将一个复杂的逻辑分成几个步骤，使这几个步骤并行
      2. 可以充分提高运行频率
      3. 流水线设计
         1. 系统时钟取决于最慢的流水线级的延迟
         2. 流水线的分割点以及级数的确定需要考虑率的因素
            1. 单位延迟时间及时钟频率的发小决定了数据通过速率
            2. 过多的级数不一定能产生最快的效果
            3. 太多寄存器的插入会导致芯片面积增加，布线困难，时钟偏差增加

第三章

第一课 亚稳态，跨时钟域电路设计

1. 同步电路设计的优点

   1. 在同步设计中，EDA工具可以保证电路系统的时序收敛，有效避免了 电路设计中竞争冒险现象
   2. 由于触发器只有在时钟边缘才改变取值，很大限度的减少了整个电路受毛刺和噪声的影响 

2. 同步时钟电路实际的缺点

   1. 时钟偏斜（clock skew）
   2. 时钟抖动（clock jitter）
   3. 时钟树综合，需要加入大量的延迟单元，使得电路的面积和功耗大大增加

3. 全局异步电路的定义

   1. 全局异步设计与同步设计最大的不同就是他的电路中的数据传输可以在任何时候发生，电路中没有一个全局的或局部的控制时钟

4. 异步电路设计的优点

   1. 模块化特性突出
   2. 对信号的延迟不敏感
   3. 没有时钟偏斜问题
   4. 有潜在的高性能特性
   5. 好的电磁兼容性
   6. 具有低功耗的特性

5. 异步电路的缺点

   1. 设计复杂
   2. 缺少相应的EDA工具的支持
   3. 在大规模集成电路设计中应该避免采用异步电路设计

6. 同一时钟域，不同的时钟域主要是针对时钟源点来说的

   1. 有好几个时钟，但他们处于一个pll，他们的相位和倍数都是可控的，因此他们是同步时钟
   2. 如果连个时钟出自不同的pll，即使频率相同，也是异步时钟
   3. 发部分数字电路设计都基于全局的时钟信号，即同步电路设计，在一个理想的全局时钟控制下，只要电路的各个功能环节都实现了时序收敛，整个电路就可以可靠工作了

7. 亚稳态的概念和原理

   1. 亚稳态是指处罚外企无法在某个规定时间段内达到一个可确认的状态

   2. 当一个触发器进入亚稳态时，既无法确定该单元的输出电平，也无法预测何时输出才能稳定在某个正确的电平上

   3. 在这个期间，触发器输出一些中间级电平，或者可能处于震荡状态，并且这种无用的输出电平可以演信号通道上的各个触发器级联式的传播下去 

   4. 亚稳态不可能从根本上消除，但可以通过采取一定的措施使其对电路的影响降低

   5. 故障间隔平均时间 $MTBF = e^{t_{MET}/C_2}/(C_1f_{clk}f_{data})$

      1. $t_{MET} = 采样的时钟周期时间 - 输出信号正常的T_{co} - 数据到达下一级寄存器的输入端口的其他延时时间T_{data}$ 寄存器从时钟上升沿触发后的时序余量时间

      2. $f_{clk}$ 接收时钟域的时钟频率

      3. $f_{data}$ 数据的变化频率

      4. $c_1,c_2$ 与器件有关的参数

8. 在不同时时钟域之间如何安全的传递信号

   1. 双锁存器法
      1. 优缺点，使用条件
      2. 使用几级DFF进行异步信号同步最合适
      3. 寄存器同步法是否可以消除亚稳态
   2. 单bit信号跨时钟域如何传输
      1. 慢到快如何实现
         1. 双锁存器法
         2. 边沿检测同步电路使用条件
      2. 快到慢如何实现
         1. 脉冲同步器的使用条件
         2. 结绳法对脉冲宽度和间隔的要求
         3. 结绳法分类
      3. 采样中，快到慢，与，慢到快，在考虑问题时有什么区别
      4. 为什么不能用慢时钟直接采样快时钟域的信号
   3. 多bit指示信号跨时钟域如何传输
   4. 多bit数据流跨时钟域如何传输