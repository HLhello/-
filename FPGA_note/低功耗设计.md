低功耗设计的目的

功耗的构成/类型

功耗分析与流程——使用EDA工具

低功耗设计与优化

## 1. 低功耗设计的目的

- 便携性设备等需求
  - 设备耗电量
- 可靠性与性能的影响
  - 耗电多发热就多，发热多电路工作频率就不高
- 成本的影响
  - 发热多设备的散热成本就高

## 2. 功耗的构成/类型

- 功耗的构成从两方面介绍，1）功耗种类，2）系统结构，3）工艺库中的功耗模型

### 1）功耗种类

a. 动态功耗

- 开关功耗/翻转功耗
- 短路功耗/内部功耗
- 开关功耗在动态功耗中占大部分比例，动态功耗主要跟电源的**供电电压、翻转率以及负载电容**有关

b. 静态功耗

- 静态功耗主要是由漏电流引起的功耗，漏电流主要是指栅极泄漏电流和亚阈值电流，静态功耗往往与工艺有关
- 计算公式 $P_{leak} = V_{DD} * I_{leak}$

c. 浪涌功耗

- 浪涌功耗是浪涌电流引起的功耗，浪涌电流是指开机或者唤醒的时候，器件流过的最大电流，因此浪涌电流也称为启动电流，一般情况下，浪涌功耗不是我们关注的地方，只是有这个功耗存在

### 2）系统结构方面

根据设备的结构或者设备的构成进行分类，以SoC为例主要分为，不同应用功耗占比不同，但是下面前三者占了绝大部分功耗

- 时钟树功耗
- 处理器功耗
- 存储器功耗
- 其他逻辑和IP核功耗
- 输入输出pad功耗

### 3）工艺库中的功耗信息

- 开关功耗计算与相关库信息
- 内部功耗与相关库信息
- 静态功耗/漏电功耗与相关库信息

## 3. 功耗的分析

### 1）功耗分析与流程概述

a. 功耗分析流程的输入输出

b. 开关行为的一些概念

c. 开关行为（文件）情况表示

### 2） 无向量分析法

a. 设置翻转变量

b. 标记翻转率

### 3） SAIF—RTL  BACK 分析法

a. RTL forward SAIF文件

b. RTL backward SAIF文件

c. 功耗的分析

### 4） SAIF—GATE分析法

a. library forward SAIF文件（简称为库SAIF文件）

b. GATE backward SAIF文件的生成

c. 功耗的分析

- power compiler 产生库SAIF文件-->VCS产生gate backward SAIF文件-->power compiler进行功耗分析

### 5）VCD转SAIF分析法

a. VCD文件的产生

b. VCD文件转换成SAIF文件

c. 功耗的分析

- VCS产生VCD文件——》power compiler 将VCD文件转换为SAIF文件——》power compiler 进行分析功耗

d. 使用vcd2saif程序的好处，主要有下面三点：

　　1.  VCD产生的速度快;

　　2.  VCD是IEEE的标准并且适用于进行后仿真;

　　3.  转换的过程快。

### 6）功耗分析报告

我们是通过分析功耗报告（report_power命令产生）来查看设计功耗的，一个功耗报告的示例部分内容如下所示：

- Cell  Internal  Power=883.0439 mW(66%)
- Net  Switching Power=453.0173 mW(34%)
- Total  Dynamic  Power=1 .3361 W(100%)
- Cell Leakage Power = 391.5133 nW



***\*一、RTL级\****

***\*1.并行结构\****

并行结构一定程度可以减低某一区域的频率，从而可能降低功耗。

***\*2.流水结构\****

“路径长度缩短为原始路径长度的1 /M。这样，一个时钟周期内充/放电电容变为C/M。如果在加入流水线之后，时钟速度不变，则在一个周期内，只需要对C/M进行充/放电，而不是原来对C进行充/放电。因此，在相同的速度要求下，可以采用较低的电源电压来驱动系统。”

***\*3.优化编码\****

通过数据编码来降低开关活动，例如用格雷码取代二进制。

***\*4.操作数隔离\****

“操作数隔离的原理就是：如果在某一段时间内，数据通路的输出是无用的，则将它的输入置成个固定值，这样，数据通路部分没有翻转，功耗就会降低。”

***\*二、门级电路\****

***\*1.门控时钟技术\****

​    芯片工作时，很大一部分功耗是由于时钟网络的翻转消耗的，对于一个设计中的寄存器组由于时钟信号CLK的翻转，寄存器组会持续在CLK的上升沿来临时读取数据输入端的数据，而这时读取的数据是不变的，这就消耗了额外的功耗。如果时钟网络较大，这部分引起的功耗损失会很大。门控技术基本原理就是通过关闭芯片上暂时用不到的功能和它的时钟，从而实现节省电流消耗的目的，门控时钟对翻转功耗和内部功耗的抑制作用最强，是低功耗设计中的一种最有效的方法。通过一个时能信号控制时钟的开关。当系统不工作时可以关闭时钟，整个系统处于非激活状态，这样就能够在某种程度上降低系统功耗。

   “通常情况下，时钟树由大量的缓冲器和反相器组成，时钟信号为设计中翻转率最高的信号，时钟树的功耗可能高达整个设计功耗30%。加入门控时钟电路后，由于减少了时钟树的开关行为，节省了开关功耗。同时，由于减少了时钟引脚的开关行为，寄存器的内部功耗也减少了。采用门控时钟，可以非常有效地降低设计的功耗，一般情况下能够节省20%~60%的功耗。”

   使用门控时钟并不符合同步设计的思想。ASIC中使用较多，FPGA中不推荐使用。

***\*2.多电压供电\****

***\*3.多阈值电压\****

根据多阈值电压单元的特点，为了满足时序的要求，关键路径中使用低阈值电压的单元(low Vt cells)，以减少单元门的延迟，改善路径的时序。而为了减少静态功耗，在非关键路径中使用高阈值电压的单元(high Vt cells)，以降低静态功耗。因此，使用多阈值电压的工艺库，我们可以设计出低静态功耗和高性能的设计。

***\*4.动态电压调节\****

***\*5.动态频率调节\****